

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developer Instructions &mdash; locopy 0.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="locopy" href="api/modules.html" />
    <link rel="prev" title="Common Recipes" href="recipes.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> locopy
          

          
          </a>

          
            
            
              <div class="version">
                0.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Basic Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">Common Recipes</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pre-commit-hooks">Pre-Commit Hooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-documentation">Generating Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-unit-tests">Run unit tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integration-tests">Integration Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="#management-of-requirements">Management of Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-distribution-archives-pypi">Generating distribution archives (PyPI)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">locopy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Developer Instructions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/developer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developer-instructions">
<h1>Developer Instructions<a class="headerlink" href="#developer-instructions" title="Permalink to this headline">¶</a></h1>
<p>Guidance for developers.</p>
<div class="section" id="pre-commit-hooks">
<h2>Pre-Commit Hooks<a class="headerlink" href="#pre-commit-hooks" title="Permalink to this headline">¶</a></h2>
<p>We use the excellent <a class="reference external" href="https://pre-commit.com/">pre-commit</a> to run the excellent
<a class="reference external" href="https://github.com/ambv/black">black</a> on all changes before commits.  <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> is included
in the black requirements below, and you’ll have to run <code class="docutils literal notranslate"><span class="pre">pre-commit</span> <span class="pre">install</span></code> once per environment
before committing changes, or else manually install <code class="docutils literal notranslate"><span class="pre">black</span></code> and run it.  If you have <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code>
installed, trying to commit a change will first run black against any changed Python files, and force
you to add/commit any changes.</p>
<p>The reason behind running black as a pre-commit hook is to let a machine make style decisions, based
on the collective wisdom of the Python community.  The only change made from the default black setup
is to allow lines up to 100 characters long.</p>
</div>
<div class="section" id="generating-documentation">
<h2>Generating Documentation<a class="headerlink" href="#generating-documentation" title="Permalink to this headline">¶</a></h2>
<p>You will need to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span></code> the test requirements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">-</span><span class="n">dev</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>From the root directory type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">sphinx</span>
</pre></div>
</div>
<p>This will automatically regenerate the api documentation using <code class="docutils literal notranslate"><span class="pre">sphinx-apidoc</span></code>.
The rendered documentation will be stored in the <code class="docutils literal notranslate"><span class="pre">/docs</span></code> directory.  The
GitHub pages sits on the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch.</p>
<p>To push the documentation changes to the <code class="docutils literal notranslate"><span class="pre">gh-pages</span></code> branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">ghpages</span> <span class="o">&amp;&amp;</span> <span class="n">git</span> <span class="n">push</span> <span class="n">origin</span> <span class="n">gh</span><span class="o">-</span><span class="n">pages</span>
</pre></div>
</div>
<p>Note about documentation: The <a class="reference external" href="http://sphinx-doc.org/latest/ext/napoleon.html">Numpy and Google style docstrings</a> are activated by default.
Just make sure Sphinx 1.3 or above is installed.</p>
</div>
<div class="section" id="run-unit-tests">
<h2>Run unit tests<a class="headerlink" href="#run-unit-tests" title="Permalink to this headline">¶</a></h2>
<p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">coverage</span></code> to run all unittests defined in the subfolder
<code class="docutils literal notranslate"><span class="pre">tests</span></code> with the help of <a class="reference external" href="http://pytest.org/">py.test</a> and
<a class="reference external" href="https://pypi.python.org/pypi/pytest-runner">pytest-runner</a>.</p>
</div>
<div class="section" id="integration-tests">
<h2>Integration Tests<a class="headerlink" href="#integration-tests" title="Permalink to this headline">¶</a></h2>
<p>Run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">integration</span></code> to run all integration tests (or just run
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">not_integration</span></code> to run only unit and not integration tests).  For the
integration tests to work, you will need:</p>
<ul class="simple">
<li>A Redshift connection that you can create tables in</li>
<li>Tokens set up in <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code> with a profile name</li>
<li>A file <code class="docutils literal notranslate"><span class="pre">~/.locopyrc</span></code> which contains credential information use for running
integration tests. It should look like the following:</li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">host</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">my.redshift.cluster.com</span>
<span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5439</span>
<span class="l l-Scalar l-Scalar-Plain">dbname</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db</span>
<span class="l l-Scalar l-Scalar-Plain">user</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">username</span>
<span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">password</span>
<span class="l l-Scalar l-Scalar-Plain">profile</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">MY_AWS_PROFILE</span>
</pre></div>
</div>
<p>The integration tests run through a number of selects, loads and unloads.  They
try to clean up after themselves, but you may not want to run them without
knowing what they’re doing.  Caveat emptor!</p>
</div>
<div class="section" id="management-of-requirements">
<h2>Management of Requirements<a class="headerlink" href="#management-of-requirements" title="Permalink to this headline">¶</a></h2>
<p>Requirements of the project should be added to <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code>.  Optional
requirements used only for testing are added to <code class="docutils literal notranslate"><span class="pre">requirements-dev.txt</span></code>. There is a third
requirements file <code class="docutils literal notranslate"><span class="pre">requirements-black.txt</span></code> which is used only for code formatting and pre-commit
hooks. Black only works with Python 3.6.0+ and conflicts with the Travis CI build (Python 3.5)</p>
</div>
<div class="section" id="generating-distribution-archives-pypi">
<h2>Generating distribution archives (PyPI)<a class="headerlink" href="#generating-distribution-archives-pypi" title="Permalink to this headline">¶</a></h2>
<p>After each release the package will need to be uploaded to PyPi. The instructions below are taken
from <a class="reference external" href="https://packaging.python.org/tutorials/packaging-projects/#generating-distribution-archives">packaging.python.org</a></p>
<p>Update / Install <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>, <code class="docutils literal notranslate"><span class="pre">wheel</span></code>, and <code class="docutils literal notranslate"><span class="pre">twine</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">setuptools</span> <span class="n">wheel</span> <span class="n">twine</span>
</pre></div>
</div>
<p>Generate distributions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">sdist</span> <span class="n">bdist_wheel</span>
</pre></div>
</div>
<p>Under the <code class="docutils literal notranslate"><span class="pre">dist</span></code> folder you should have something as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">/</span>
<span class="n">locopy</span><span class="o">-</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="nb">any</span><span class="o">.</span><span class="n">whl</span>
<span class="n">locopy</span><span class="o">-</span><span class="mf">0.1</span><span class="o">.</span><span class="mf">0.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p>Finally upload to PyPi:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># test pypi</span>
<span class="n">twine</span> <span class="n">upload</span> <span class="o">--</span><span class="n">repository</span><span class="o">-</span><span class="n">url</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">test</span><span class="o">.</span><span class="n">pypi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">legacy</span><span class="o">/</span> <span class="n">dist</span><span class="o">/*</span>

<span class="c1"># real pypi</span>
<span class="n">twine</span> <span class="n">upload</span> <span class="n">dist</span><span class="o">/*</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api/modules.html" class="btn btn-neutral float-right" title="locopy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="recipes.html" class="btn btn-neutral" title="Common Recipes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Capital One Services, LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>